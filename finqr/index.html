<!DOCTYPE html>
<html lang="en" dir="ltr">
	<head>
		<meta charset="utf-8">
		<title>Hall Pass (WIP)</title>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
		<script type="text/javascript" src="qrcode.js"></script>
	</head>
	<body>
		<h1>SECRET APPLICATION v0.0.1 (WIP) Node.Js 10.6.5</h1>
		<input id="text" type="text" value="" placeholder="ENTER NAME HERE" style="width:80%" /><br />
		<div id="qrcode" style="width:100px; height:100px; margin-top:15px;"></div>
	</body>

  <script>
	var qrcode = new QRCode(document.getElementById("qrcode"), {
		width : 512,
		height : 512
	});

	function makeCode () {
		let name = String(document.getElementById("text").value);
		var obj = { name: name, date: new Date() };
		var myJSON = JSON.stringify(obj);
	$.ajax({
			contentType: "application/json",
			dataType : "json",
			method: "POST",
			url: "https://austinleath.com/finqr/hpass.php",
			data: myJSON
	})
		qrcode.makeCode(myJSON);
	}

	function isEmpty() {
		let name = String(document.getElementById("text").value);
	  if (name === "") {
	    return false;
	  } else {
	    return true;
	  }
	}

	window.addEventListener("keydown", checkKeyPressed, false);

  function checkKeyPressed(e) {
    if (e.keyCode == 13) {
			if(isEmpty()) {
				makeCode();
			}
    }
  }
	</script>
</html>
